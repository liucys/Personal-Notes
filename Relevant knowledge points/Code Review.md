[TOC]

`Code Review` 是一种通过复查代码提高代码质量的过程，在[XP](https://baike.baidu.com/item/xp/776028)方法中占有极为重要的地位，是软件工程中一个不可缺少的环节。

Code Review 是一种用来确认方案设计和代码实现的质量保证机制，通过这个机制我们可以对代码、测试过程和注释进行检查。通过 Code Review 可以达到以下目的：

- 在项目早期就能够发现代码中的 BUG。
- 提高代码质量
- 促进团队内部知识共享，提高团队整体水平。
- 可以让其他并不熟悉代码的人知道作者的意图和想法，从而可以在以后轻松维护代码。
- 帮助初级开发人员学习高级开发人员的经验，达到知识共享。
- 避免开发人员犯一些很常见的，很普通的错误。
- 保证项目组人员的良好沟通。
- 使项目或产品的代码更容易维护。

&nbsp;

### Code Review 的前提：

- Code Review 人员是否理解 Code Review 的概念和 Code Review 需要做什么。
- 代码是否已经正确的 build，build 的目的是使得代码已经不存在基本的语法错误。
- 代码执行时功能是否正确。
- Review 人员是理解了代码。
- 开发人员是否对代码做了单元测试。

&nbsp;

### Code Review 主要做什么：

其实 Code Review 主要检查代码中是否存在以下方面的问题：代码的一致性、编码风格、代码的安全问题、代码冗余、是否正确设计以满足需求（性能、功能）等等。

- 完整性检查（Completeness）

```js
代码是否完全实现了设计文档中提出的功能需求
代码是否已按照设计文档进行了集成和 Debug
代码是否已创建了需要的数据库，包括正确的初始化数据
代码中是否存在任何没有定义或没有引用到的变量、常数或数据类型
```

- 一致性检查（Consistency）

```js
代码的逻辑是否符合设计文档
代码中使用的格式、符号、结构等风格是否保持一致
```

- 正确性检查（Correctness）

```js
代码是否符合制定的标准;
所有的变量都被正确定义和使用;
所有的注释都是准确的;
所有的程序调用都使用了正确的参数个数;
```

- 可修改性检查（Modifiability）

```js
代码涉及到的常量是否易于修改(如使用配置、定义为类常量、使用专门的常量类等)
代码中是否包含了交叉说明或数据字典，以描述程序是如何对变量和常量进行访问的
代码是否只有一个出口和一个入口（严重的异常处理除外）
```

- 可预测性检查（Predictability）

```js
代码所用的开发语言是否具有定义良好的语法和语义;
是否代码避免了依赖于开发语言缺省提供的功能;
代码是否无意中陷入了死循环;
代码是否是否避免了无穷递归;
```

- 健壮性检查（Robustness）

```js
代码是否采取措施避免运行时错误（如数组边界溢出、被零除、值越界、堆栈溢出等）
```

- 结构性检查（Structuredness）

```js
程序的每个功能是否都作为一个可辩识的代码块存在;
循环是否只有一个入口;
```

- 可追溯性检查（Traceability）

```js
代码是否对每个程序进行了唯一标识
是否有一个交叉引用的框架可以用来在代码和开发文档之间相互对应
代码是否包括一个修订历史记录，记录中对代码的修改和原因都有记录
是否所有的安全功能都有标识
```

- 可理解性检查（Understandability）

```js
注释是否足够清晰的描述每个子程序
是否使用到不明确或不必要的复杂代码，它们是否被清楚的注释
使用一些统一的格式化技巧（如缩进、空白等）用来增强代码的清晰度
是否在定义命名规则时采用了便于记忆，反映类型等方法
每个变量都定义了合法的取值范围
代码中的算法是否符合开发文档中描述的数学模型
```

- 可验证性检查(Verifiability)

```js
代码中的实现技术是否便于测试;
```

&nbsp;

事实上，`Code Review 应该讨论的是功能实现、架构设计、代码质量。而不应该去做检查代码风格和编程规范、检查常规的 bad smell 和代码 bug（应该通过静态工具、单元测试、集成测试和性能测试等来发现）`

- bad smell：重复代码、过长函数、过大类、过于亲密的两个 classes 等。

我们在完成编码工作的同时，也需要时时分享架构设计，交流各自的代码，Code Review 正是时时分享架构设计，交流代码最好的方式。这是我们需要做 Code Review 的根本原因。
